<!-- Mobile hamburger menu for left navigation -->
<div class="row full-width">
  <div class="off-canvas-nav-bar sticky" id="mobileMenuBar">
    <nav class="title-bar hide-for-large" data-topbar="" role="navigation">
      <section class="title-bar-left">
        <button class="menu-icon" type="button" style="outline: none;" data-toggle="mobileMenu">
          <span></span>
        </button>
      </section>
      <span class="title-bar-title">
    </nav>
  </div>
</div>

<div class="row full-width">

  <!-- Left navigation -->
  <div class="show-for-large large-3 columns menu">
    <nav role="navigation" class="sidebar-nav">
      <header>Filter by:</header>
      <ul class="sidebar-nav-items columns" data-magellan-expedition>
        <li>System type</li>
        <li><input type="checkbox" class="pm_bound" checked="true" id="systemType_CM" /><label for="systemType_CM">Channel Manager</label></li>
        <li><input type="checkbox" class="pm_bound" checked="true" id="systemType_PMS" /><label for="systemType_PMS">Property Management System</label></li>
        <li><input type="checkbox" class="pm_bound" checked="true" id="systemType_CRS" /><label for="systemType_CRS">Central Reservation System</label></li>
      </ul>
    </nav>
  </div>

  <!-- Main content -->
  <div class="off-canvas-wrapper">
    <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
      <div class="off-canvas position-left hide-for-large" id="mobileMenu" data-off-canvas="" data-auto-focus="false"></div>
      <div class="off-canvas-content" data-off-canvas-content="">
        <div class="small-12 medium-10 medium-offset-1 large-8 large-offset-3 xlarge-8 xxlarge-6 columns end api-content">

          <p>
            You have many options for connecting your property to the Expedia Global Marketplace.
            Search our provider partners and find the system that best fits your needs.
          </p>

          <div>
            <h2>Sort by:</h2>
            <input type="radio" class="pm_bound hidden" name="sort" id="sort_score" value="score" checked="true" /><label for="sort_score">Score</label>
            <input type="radio" class="pm_bound hidden" name="sort" id="sort_systemName" value="systemName" /><label for="sort_systemName">System Name</label>
            <input type="radio" class="pm_bound hidden" name="sort" id="sort_providerName" value="providerName" /><label for="sort_providerName">Company Name</label>
          </div>

          <hr/>

          <div id="systems"></div>

        </div>
      </div>
    </div>
  </div>

</div>

<script>
$(function() {

var systems = [
  {
    'systemName': 'InnLink CRS',
    'providerName': 'Sabre Hospitality Solutions (SynXis)',
    'systemType': 'PMS',
    'score': 99
  },
  {
    'systemName': 'BookVisit',
    'providerName': 'Visit Technology',
    'systemType': 'CM',
    'score': 50
  }
];

function filterSystems(systems) {
  var i, system, filtered = [], systemTypes = {};

  systemTypes['CM'] = $('#systemType_CM').prop('checked');
  systemTypes['PMS'] = $('#systemType_PMS').prop('checked');
  systemTypes['CRS'] = $('#systemType_CRS').prop('checked');

  for (i = 0; i < systems.length; i++) {
    system = systems[i];
    if (!systemTypes[system.systemType]) {
      continue;
    }
    filtered.push(system);
  }
  return filtered;
}

function sortSystems(systems) {
  var sortProperty = $('input[name=sort]:checked').val();
  systems.sort(function (systemA, systemB) {
    var valueA = systemA[sortProperty];
    var valueB = systemB[sortProperty];
    if (valueA > valueB) {
      return 1;
    } else if (valueA < valueB) {
      return -1;
    }
    return 0;
  });
  if (sortProperty === 'score') {
    systems.reverse();
  }
  return systems;
}

function createSystemView(system) {
  var view = $('<div>');
  view.text(system.systemName + ' by ' + system.providerName);
  return view;
}

function displaySystems(systems) {
  var i, system, views = [], container = $('#systems');
  for (i = 0; i < systems.length; i++) {
    system = systems[i];
    system.view = system.view || createSystemView(system);
    views.push(system.view);
  }
  container.empty();
  container.append(views);
}

function renderSystems() {
  displaySystems(sortSystems(filterSystems(systems)));
}

$('.pm_bound').change(renderSystems);

renderSystems();

});
</script>
