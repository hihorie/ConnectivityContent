# Booking Confirmation API Definition

## Introduction

When a customer returns to Expedia to review their reservation, or when they receive confirmations or updates for their reservation via e-mail, Expedia shall include the hotel’s confirmation number. The presence of the hotel confirmation number guarantees that the booking was properly received and confirmed by the hotel system and thereby raises customer confidence at check-in. The confirmation number also makes consolidation between Expedia and the hotel easier for accounting and tracking purposes.
The Booking Confirmation (BC) API is the mechanism EQC partners are required to implement to provide Expedia with the hotel’s confirmation number for all bookings retrieved via the BR interface. Unconfirmed bookings will revert to fax or email once the booking expiration time is reached.

### Supported Features for Booking Confirmaion
EQC partner must use the booking confirmation API to confirm bookings retrieved electronically (reservations, modifications, and cancellations):

1. Confirmation numbers have to be received before bookings expire. Else, bookings will fall back to fax or email. Expedia’s booking expiration strategy is based on booking window:
a. For same-day arrival (based on midnight in hotel’s local timezone): bookings will expire 30 minutes after their creation by customer.
b. For next-day arrival (any bookings created between midnight and 23:59:59 the day before arrival, based on hotel’s local timezone): bookings will expire 60 minutes after their creation by customer.
c. For any longer booking window, bookings will expire 24 hours after their creation by customer.
2. Booking confirmation numbers can be updated for already confirmed bookings up to 8 days after guest’s departure date.

---

## Booking Confirmation Request
The booking confirmation request message (BC RQ) allows EQC partners to send hotel confirmation numbers for new, modified and/or cancelled bookings on Expedia Inc. points of sale.

### Booking Confirmation Request Schema Overview

insert Picture here

### Booking Confirmation Request Schema Complete Definition

 L |Data element|Data type| O |Description|EQC validations
---|------------|---------|---|-----------|-------------
0|BookingConfirmRQ|-||Root element|
0|@xmlns|URL||Namespace which belongs to this message. Also used to validate version of schema on which this message is based. <p>Namespace for BC RQ messages</p><p> http://www.expediaconnect.com/EQC/BC/2007/09</p><p> Valid namespace, defined by at least one version of BC schema.</p>
1|Authentication|-||Required information to grant access to Expedia QuickConnect interface – stored in next two attributes.
1|@username|String||Username for Expedia QuickConnect login (case sensitive), provided by Expedia.|<ul><li>Minimum length: 4</li><li>Maximum length: 30</li><li>Username exists</li><li>User is allowed to access Expedia QuickConnect</li></ul>
1|@password|String||Password for Expedia QuickConnect login (case sensitive), provided by Expedia.|<ul><li>Minimum length: 6</li><li>Maximum length: 30</li><li>Password fits with the username</li></ul>
1|Hotel|-||Information about Hotel|
1|@id|Integer||Hotel ID defined by Expedia and uniquely identifying a property in Expedia system.|<ul><li>Positive integer of 14 digits or less</li><li>Hotel ID is valid</li><li>Hotel ID in Expedia system is assigned to the credentials provided in Authentication node.</li></ul>
1|BookingConfirmNumbers|-|||
2|BookingConfirmNumber|-|||
2|@bookingID|Integer||Booking ID generated by Expedia. Uniquely identifies a booking. Should be used to link modifications and cancellations to initial bookings in hotel system - must be kept in hotel system.|- Positive integer of 14 digits or less
2|@bookingType|Enum||Type of booking record. Possible values are: "Book" for new reservations, "Modify" for modified bookings and "Cancel" for cancelled bookings.|- Value in the list specified in the enumeration given by the schema.<p>The specified booking must  have the same new, modified or cancelled status as described by this booking type.</p>
2|@confirmNumber|String||Hotel confirmation number for this booking.|Maximum length: 50
2|@confirmTime|String||Time at which the confirmation number was generated by the hotel|<p>Valid date/time occurring between booking time and the present.</p><p>Timestamp as defined in ISO 8601 format. Should be:</p> <p>YYYY-MM-DDThh:mm:ssZ for time in UTC.</p> <p>To indicate a different time zone, the local time shall be immediately followed by a sign, + or -, then by the difference from UTC represented as hh:mm; for example, local Pacific Standard Time would look like "2008-02-28T11:55:00-08:00”.</p>

## Booking Confirmation Response

The booking confirmation response message (BC RS) contains a success or error message for the confirmation of a new, modified or cancelled booking. Note that a success message may include a warning that should require action by the EQC partner. There is one response per booking update, so if a booking confirmation request sends a confirmation update for 5 bookings, then there will be 1 response message sent back with additional nodes for each warning or error. 

### Booking Confirmation Response Schema Overview

insert Picture here

### Booking Confirmation Response Schema Complete Definition

 L |Data element|Data type| O |Description
---|------------|---------|----|----------
0|BookingConfirmRS|NA||Root element
0|@xmlns|URL||Namespace which belongs to this message. Also used to validate version of schema on which this message is based. Namespace for BC RS messages http://www.expediaconnect.com/EQC/BC/2007/08
1|Success|NA||<p>Element appears if the request to update availability and rates was successful. The node will be empty.</p><p>If this element is present, Error node(s) does not appear.</p>
2|Warning|String|*|<p>Detailed description of a warning.</p><p>Occurrence of this element means the update request was successfully received by Expedia, but the update could not be made. For example, if the requested booking does not match the specified hotel, a warning is sent that the update was refused.</p><p>Maximum length: 1024 characters.</p>
2|@code|Int||Code for the warning, between 10,000 and 11,000.
2|@bookingID|Integer||<p>Booking ID generated by Expedia. Uniquely identifies a booking. Should be used to link modifications and cancellations to initial bookings in hotel system - must be kept in hotel system.</p><p>Positive integer of 14 digits or less</p>
2|@bookingType|Enum||Type of booking record. Possible values are: "Book" for new reservations, "Modify" for modified bookings and "Cancel" for cancelled bookings.
2|@confirmNumber|String||<p>Hotel Confirmation Number for this booking.</p><p>Maximum length: 50</p>
1|Error|String||<p>Detailed description of an error message.</p><p>One or more of this element appears if the request failed.</p><p>If this element is present, Success node does not appear. </p><p>Maximum length: 1024 characters.</p>
1|@code|Int||<p>Code for this error, for example: authentication, xml structure, business validation.</p><p>Code will be between 1000 and 10,000.</p>


### Booking Confirmation Validation Process
To update a booking with a confirmation number successfully, the following validations are applied through EQC for each confirmation sent in the BC RQ message:
* The username and password are valid
* The bookingID belongs to the specified hotel
* The check-out date has not passed
* The confirmation number is more recent than any existing confirmation number for the booking. For instance, if the EQC partner sends two BC requests for the same booking, EQC will look at the timestamp included in the message and ensure the most recent is applied.
* The booking type specified in the confirmation matches the new, modified, or cancelled state of the booking. Note that if a customer modifies a booking before Expedia sends the booking details to the EQC partner in a booking retrieval message, the confirmation booking type should still be set to “Book” because the first delivery of a booking to the EQC partner is always considered a new booking. 
An additional validation makes sure that no more than 10 confirmation numbers are sent in the BC RQ message.

## Guidlines and Best Practices

When designing the electronic interface used to connect to Expedia QuickConnect to confirm bookings, the EQC partner should make sure to read and understand the following guidelines, recommendations and best practices.

### EQC Simulator TOol

Please see the specific section for this.

### Retrieval and Confirmation Frequencey vs. Booking 
Expedia requires that EQC partners retrieve and confirm bookings within 30 minutes of their creation by the customer. Partners connected via Expedia QuickConnect need not only retrieve bookings using BR interface, but also confirm them using the Booking Confirmation API within this delay

### Booking Confirmation REsponses with Warning Require Action
If a warning is included in the BC RS message, the hotel confirmation number could not be updated for the booking at Expedia. Efforts should be made to capture these warnings and make necessary corrections to your booking confirmation request parameters.

### Alarms and Monitoring
EQC partners should include monitors in their interface implementation that will allow partners to see the ratio of successful BC requests and to get detailed information on any errors. Alarms should also be created to notify concerned individuals (e.g. EQC partner tech support) when the rate of message errors returned by Expedia exceeds an accepted threshold. It is recommended that an alarm be triggered when BC messages return errors at a rate of 10% or more.
Partners should review errors frequently to ensure that bookings are being confirmed



